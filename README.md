### Ваш дружелюбный сервис по отправке Email рассылок
Сделано специально для тестового задания Mailganer

## Дмитрий Туманов
[hh.ru](https://hh.ru/resume/c6d3b387ff0b59362b0039ed1f5a585a6b5a58) | [telegram](https://t.me/icyrog)

### Описание методов работы

- Создать новый список для рассылки ё
POST /api/list/    - ответ id нового пустого списка

- Добавить пользователя в список для рассылки
POST /api/list/{id}    - где {id} - id  списка, полученное при создании
Тело запроса должно иметь JSON структуру пользователя с полями, которые будут использоваться в шаблоне
Адрес для уведомления пользователя должен находиться в поле    email  , остальные названия могут быть любыми

- Добавить сразу несколько пользователей
POST /api/list/{id}/batch    - тело запроса - JSON список структур с теми же требованиями как при одиночном добавлении

- Получить список пользователей в рассылке
GET /api/list/{id}    - ответ - список  JSON структур со всей информацией о  пользователе

- Добавить шаблон для рассылки конкретному списку
POST /api/list/{id}/template    - тело запроса -  шаблон для рассылки в формате    text/html
Для реализации шаблонов сервис использует [html/template](https://pkg.go.dev/html/template), все правила форматирования сохраняются
Простой пример:
html



Здравствуйте {{ .name}}

У Вас {{ .bonuses}} бонусов

Потратить их можно в личном кабинете по ссылке





Предполагается, что изначальная структура информации о пользователе в примере выглядит так:
json
{
"email": "moya@govorit.net",
"bonuses": "1200",
"link": "bonusshop.ru/id=4535345432"
}


Шаблоны сохраняются в    templates/  , путь по умолчанию можно изменить при запуске

- Получить информацию о статистике прочтения писем из рассылки
GET api/list/{id}/stat    - ответ - список структур  JSON вида:
javascript

{
"email": "rasputin@grand.ma", //адрес прочитавшего
"time": "Fri, 14 Oct 2022 04:31:50 MSK" //время прочтения в формате RFC1123
}


Оповещение о прочтении реализовано по [RFC3798](https://datatracker.ietf.org/doc/html/rfc3798)
Можно добавить ссылку на обработчик API    GET api/{email}/read    для проверки прочтения, если это необходимо

- Запустить рассылку
Запустить рассылку можно через Celery.
Функция postman.mail(id) принимает id списка для рассылки и возвращает кол-во адресов, на которые будет отправлен email
Возвращает 0, если при рассылке произошла ошибка

###### Был бы очень рад дальше работать с вами : )



